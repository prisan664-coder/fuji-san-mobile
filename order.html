<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f6f7fb;
            min-height: 100vh;
        }

        .nav-brand {
            font-weight: 700;
            letter-spacing: 1px
        }

        .center-box {
            max-width: 420px;
            margin: auto;
        }

        .card-shop {
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .06);
            background: #ffffff;
        }

        .screenshot-ready {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
        }
    </style>
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand nav-brand" href="index.html"> Fuji Mobile Shop</a>
            <a class="navbar-brand nav-brand" href="summary_order.html"> Order history</a>
        </div>
    </nav>

    <div class="container py-5">
        <div class="center-box">
            <div class="card card-shop p-4 screenshot-ready">

                <h4 class="text-center mb-4">üõí ‡ªÄ‡∫û‡∫µ‡ªà‡∫°‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫™‡∫±‡ªà‡∫á‡∫ä‡∫∑‡ªâ</h4>

                <div class="mb-3">
                    <label>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡∫™‡∫±‡ªà‡∫á</label>
                    <input type="date" id="orderDate" class="form-control">
                </div>

                <div class="mb-3">
                    <label>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡∫à‡∫±‡∫î‡∫™‡∫ª‡ªà‡∫á</label>
                    <input type="date" id="shippingDate" class="form-control">
                </div>

                <div class="mb-3">
                    <label>‡∫™‡∫ª‡ªà‡∫á‡∫à‡∫≤‡∫Å‡∫Æ‡ªâ‡∫≤‡∫ô</label>
                    <input type="text" id="fromShop" class="form-control">
                </div>

                <div class="mb-3">
                    <label>‡∫ä‡∫∑‡ªà‡∫•‡∫π‡∫Å‡∫Ñ‡ªâ‡∫≤</label>
                    <input type="text" id="customerName" class="form-control">
                </div>

                <hr>
                <h6 class="text-center mb-3">üßæ ‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤</h6>

                <div class="mb-2">
                    <input type="text" id="productName" class="form-control" placeholder="‡∫ä‡∫∑‡ªà‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤">
                </div>

                <div class="mb-2">
                    <input type="number" id="qty" class="form-control" placeholder="‡∫à‡∫≥‡∫ô‡∫ß‡∫ô">
                </div>

                <div class="mb-2">
                    <input type="number" id="priceBuy" class="form-control" placeholder="‡∫•‡∫≤‡∫Ñ‡∫≤‡∫ä‡∫∑‡ªâ">
                </div>

                <div class="mb-3">
                    <input type="number" id="priceSell" class="form-control" placeholder="‡∫•‡∫≤‡∫Ñ‡∫≤‡∫Ç‡∫≤‡∫ç">
                </div>

                <button onclick="addItem()" class="btn btn-outline-primary w-100 mb-3">‚ûï ‡ªÄ‡∫û‡∫∂‡ªà‡∫°‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤</button>

                <ul id="itemList" class="list-group mb-3"></ul>

                <h5 class="text-center mb-3">‡∫•‡∫ß‡∫°‡∫•‡∫≤‡∫Ñ‡∫≤‡∫ó‡∫±‡ªâ‡∫á‡∫´‡∫°‡∫ª‡∫î: <span id="totalPrice">0</span> ‡∫Å‡∫µ‡∫ö</h5>

                <div class="d-grid gap-2">
                    <button onclick="saveOrder()" class="btn btn-success">‚úÖ ‡∫ö‡∫¥‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫ó‡∫±‡∫á‡∫´‡∫°‡∫ª‡∫î</button>
                    <button onclick="printReceipt()" class="btn btn-warning">üßæ ‡∫™‡∫±‡ªà‡∫á‡∫û‡∫¥‡∫°‡ªÉ‡∫ö‡∫ö‡∫¥‡∫ô</button>
                </div>

            </div>
        </div>
    </div>

    <script>
        let items = [];
        let total = 0;

        function addItem() {
            const name = document.getElementById('productName').value;
            const qty = parseFloat(document.getElementById('qty').value || 0);
            const priceBuy = parseFloat(document.getElementById('priceBuy').value || 0);
            const priceSell = parseFloat(document.getElementById('priceSell').value || 0);

            if (!name || qty <= 0) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô");
                return;
            }

            items.push({ name, qty, priceBuy, priceSell });

            renderItems();

            document.getElementById('productName').value = '';
            document.getElementById('qty').value = '';
            document.getElementById('priceBuy').value = '';
            document.getElementById('priceSell').value = '';
        }

        function renderItems() {
            const list = document.getElementById('itemList');
            list.innerHTML = '';
            total = 0;

            items.forEach((item, index) => {
                const sum = item.qty * item.priceSell;
                total += sum;

                const li = document.createElement('li');
                li.className = "list-group-item d-flex justify-content-between align-items-center";
                li.innerHTML = `
                    ${item.name} √ó ${item.qty} = ${sum} ‡∏ö‡∏≤‡∏ó
                    <button class="btn btn-sm btn-danger" onclick="deleteItem(${index})">‡∏•‡∏ö</button>
                `;
                list.appendChild(li);
            });

            document.getElementById('totalPrice').innerText = total;
        }

        function deleteItem(index) {
            items.splice(index, 1);
            renderItems();
        }

        function saveOrder() {
            if (items.length === 0) {
                alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤");
                return;
            }

            const order = {
                orderDate: document.getElementById('orderDate').value,
                shippingDate: document.getElementById('shippingDate').value,
                fromShop: document.getElementById('fromShop').value,
                customerName: document.getElementById('customerName').value,
                items: items,
                totalPrice: total
            };

            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));

            alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");

            items = [];
            renderItems();
        }

        // ‚úÖ ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
        function printReceipt() {
            if (items.length === 0) {
                alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤");
                return;
            }

            const orderDate = document.getElementById('orderDate').value;
            const shippingDate = document.getElementById('shippingDate').value;
            const fromShop = document.getElementById('fromShop').value;
            const customerName = document.getElementById('customerName').value;

            let html = `<h3>Fuji Mobile Shop</h3>`;
            html += `<p>‡∫•‡∫π‡∫Å‡∫Ñ‡ªâ‡∫≤: ${customerName}</p>`;
            html += `<p>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡∫™‡∫±‡ªà‡∫á‡∫ä‡∫∑‡ªâ: ${orderDate}</p>`;
            html += `<p>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡∫à‡∫±‡∫î‡∫™‡∫ª‡ªà‡∫á: ${shippingDate}</p>`;
            html += `<p>‡∫™‡∫ª‡ªà‡∫á‡∫à‡∫≤‡∫Å‡∫Æ‡ªâ‡∫≤‡∫ô: ${fromShop}</p>`;
            html += `<hr>`;
            html += `<table border="1" cellspacing="0" cellpadding="5" style="width:100%;border-collapse:collapse;">`;
            html += `<tr><th>‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤</th><th>‡∫à‡∫≥‡∫ô‡∫ß‡∫ô</th><th>‡∫•‡∫≤‡∫Ñ‡∫≤</th><th>‡∫•‡∫ß‡∫°</th></tr>`;

            items.forEach(item => {
                const sum = item.qty * item.priceSell;
                html += `<tr>
                            <td>${item.name}</td>
                            <td>${item.qty}</td>
                            <td>${item.priceSell}</td>
                            <td>${sum}</td>
                         </tr>`;
            });

            html += `<tr>
                        <td colspan="3" style="text-align:right"><b>‡∫•‡∫ß‡∫°‡∫•‡∫≤‡∫Ñ‡∫≤‡∫ó‡∫±‡ªâ‡∫á‡∫´‡∫°‡∫ª‡∫î:</b></td>
                        <td>${total}</td>
                     </tr>`;
            html += `</table>`;

            const newWindow = window.open('', '', 'width=600,height=600');
            newWindow.document.write(html);
            newWindow.document.close();
            newWindow.print();
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>