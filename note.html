<!DOCTYPE html>
<html lang="lo">

<head>
    <meta charset="UTF-8">
    <title>‡∫•‡∫∞‡∫ö‡∫ª‡∫ö‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            background: #f7f7f7;
        }

        .navbar {
            background: #333;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            font-size: 19px;
            padding: 8px 12px;
            display: inline-block;
        }

        input,
        button {
            padding: 10px;
            margin: 5px;
        }

        /* üî• MODIFIED: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            overflow: hidden;
            /* **‡∏•‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á (border: none;)** */
            border: none;
        }

        th {
            background: #4CAF50;
            /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
            color: white;
            font-weight: 500;
            text-transform: none;
            padding: 10px 8px;
            /* ‡πÉ‡∏™‡πà padding ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö header */
            border: 1px solid #4CAF50;
            /* ‡πÉ‡∏´‡πâ header ‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
        }

        td {
            border-top: 1px solid #e0e0e0;
            /* ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (Top Border) */
            border-left: none;
            border-right: none;
            /* **‡∏•‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á** */
            padding: 10px 8px;
            text-align: center;
        }

        /* üî• NEW/MODIFIED: ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û */
        #expenseTable td:nth-child(1) {
            /* ‡∏•‡∏≥‡∏î‡∏±‡∏ö (‡∫•‡∫≥‡∫î‡∫±‡∫ö) */
            width: 5%;
            min-width: 40px;
            font-weight: normal;
            color: #333;
            text-align: center;
        }

        #expenseTable td:nth-child(2) {
            /* ‡∫ß‡∫±‡∫ô‡∫ó‡∫µ (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà) */
            width: 15%;
            min-width: 100px;
            text-align: center;
        }

        #expenseTable td:nth-child(3) {
            /* ‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) */
            text-align: left;
            padding-left: 10px;
            width: 40%;
            min-width: 150px;
        }

        #expenseTable td:nth-child(4) {
            /* ‡∫•‡∫≤‡∫Ñ‡∫≤ (‡∏£‡∏≤‡∏Ñ‡∏≤) - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≠‡∏ô‡πÜ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤*/
            text-align: right;
            padding-right: 15px;
            width: 15%;
            min-width: 90px;
            font-weight: bold;
            color: #d9534f;
            background-color: #ffeaea;
            /* ‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π‡∏≠‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏£‡∏≤‡∏Ñ‡∏≤ */
        }

        /* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö */
        #expenseTable td:nth-child(5),
        #expenseTable td:nth-child(6) {
            width: 10%;
            min-width: 50px;
        }

        /* üî• NEW: ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏†‡∏≤‡∏û */
        #expenseTable button {
            background-color: white;
            color: #333;
            border: 1px solid #ccc;
            padding: 5px 8px;
            /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
            border-radius: 2px;
            /* ‡∏Ç‡∏≠‡∏ö‡∏°‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            cursor: pointer;
            width: 30px;
            height: 30px;
            line-height: 1;
            /* ‡∏à‡∏±‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
            font-size: 14px;
        }

        .summary {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
        }

        #editBox,
        #deleteConfirmBox {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, .5);
            display: none;
            justify-content: center;
            align-items: center;
        }

        #editContent,
        #deleteContent {
            background: #fff;
            padding: 20px;
            width: 300px;
            border-radius: 8px;
        }

        #deleteContent button {
            width: 45%;
        }

        /* Style ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Notification (‡∏à‡∏≥‡∏•‡∏≠‡∏á) */
        .notification {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: #5cb85c;
            color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
            /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ */
            transition: opacity 0.5s;
            max-width: 300px;
        }

        .daily-reminder {
            background-color: #f0ad4e;
            /* ‡∏™‡∏µ‡∏™‡πâ‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ */
        }

        .save-complete {
            background-color: #5cb85c;
            /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å */
        }

        /* Custom Alert Modal Style (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) */
        #customAlertBox {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, .6);
            display: none;
            /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å */
            justify-content: center;
            align-items: center;
            z-index: 2000;
            /* ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á */
            backdrop-filter: blur(2px);
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
        }

        #customAlertContent {
            background: #fff;
            padding: 30px;
            width: 300px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: fadeIn 0.3s ease-out;
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Animation */
        }

        #customAlertContent p {
            font-size: 16px;
            margin-bottom: 20px;
            color: #333;
            font-weight: bold;
        }

        #customAlertContent button {
            background: #28a745;
            /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° OK ‡πÉ‡∏ô‡∏†‡∏≤‡∏û */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s;
        }

        #customAlertContent button:hover {
            background: #1e7e34;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* --- üî• NEW: Style ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå --- */
        .share-container {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        .share-container h4 {
            margin-top: 0;
            color: #555;
        }

        .share-list {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .share-list li {
            display: inline;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            padding: 8px 15px;
            border-radius: 5px;
            color: white;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .share-btn i {
            margin-right: 5px;
        }

        .btn-facebook {
            background: #3b5998;
        }

        .btn-twitter {
            background: #55acee;
        }

        .btn-googleplus {
            background: #dd4b39;
        }

        .btn-linkedin {
            background: #007bb5;
        }

        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° */
        .btn-line {
            background: #00c300;
        }

        .btn-whatsapp {
            background: #25d366;
        }

        /* --- End Share Style --- */
    </style>
</head>

<body>
    <div class="navbar"> <a href="index.html">üè† ‡∫Å‡∫±‡∫ö‡ªú‡ªâ‡∫≤‡∫´‡∫º‡∫±‡∫Å</a> 
    <a href="https://prisan664-coder.github.io/sale.com/">üè† ‡∫Å‡∫ª‡∫î‡ªÑ‡∫õ‡∫´‡∫ô‡ªâ‡∫≤‡∫Ç‡∫≤‡∫ç‡∫™‡∫¥‡∫ô‡∫Ñ‡ªâ‡∫≤</a>
    <a href="docu-note.html">‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡ªÄ‡∫•‡∫∑‡ªà‡∫≠‡∫á‡∫•‡∫≤‡∫ß</a> </div>
    <h2>üí∞ ‡∫•‡∫∞‡∫ö‡∫ª‡∫ö‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç‡∫õ‡∫∞‡∫à‡∫≥‡∫ß‡∫±‡∫ô</h2>
    <label>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label> <input type="date" id="dateInput"><br>
    <label>‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô:</label> <input type="text" id="itemInput" placeholder="‡∫ä‡∫∑‡ªâ‡∫´‡∫ç‡∫±‡∫á?"><br>
    <label>‡∫•‡∫≤‡∫Ñ‡∫≤:</label> <input type="number" id="priceInput" placeholder="0"><br>
    <button onclick="saveExpense()">‚ûï ‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô</button>
    <hr>
    <label>‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô:</label> <select id="monthSelect" onchange="loadMonth()"></select>
    <div class="summary">
        <h3>üìä ‡∫™‡∫∞‡∫´‡∫º‡∫∏‡∫ö‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô</h3>
        <p id="todayTotalText" style="color:#d9534f;font-weight:bold;"></p>
        <p id="totalText">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: 0 ‡∫Å‡∫µ‡∫ö</p>
    </div>
    <button onclick="exportExcel()" style="background:#1f7cff;color:white;border:none;border-radius:5px;"> üì• Export
        Excel </button>
    <table>
        <thead>
            <tr>
                <th>‡∫•‡∫≥‡∫î‡∫±‡∫ö</th>
                <th>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ</th>
                <th>‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô</th>
                <th>‡∫•‡∫≤‡∫Ñ‡∫≤</th>
                <th>‡ªÅ‡∫Å‡ªâ‡ªÑ‡∫Ç</th>
                <th>‡∫•‡∫∂‡∫ö</th>
            </tr>
        </thead>
        <tbody id="expenseTable"></tbody>
    </table>
    <div id="editBox">
        <div id="editContent">
            <h3>‚úè ‡ªÅ‡∫Å‡ªâ‡ªÑ‡∫Ç‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô</h3>
            <label>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label> <input type="date" id="editDate"><br>
            <label>‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô:</label> <input type="text" id="editItem"><br>
            <label>‡∫•‡∫≤‡∫Ñ‡∫≤:</label> <input type="number" id="editPrice"><br>
            <button onclick="saveEdit()">üíæ ‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å</button> <button onclick="closeEdit()">‚ùå ‡∫õ‡∫¥‡∫î</button>
        </div>
    </div>
    <div id="deleteConfirmBox">
        <div id="deleteContent">
            <h3 style="color:red;">‚ö† ‡∫¢‡∫∑‡∫ô‡∫¢‡∫±‡∫ô‡∫Å‡∫≤‡∫ô‡∫•‡∫ª‡∫ö</h3>
            <p>‡∫ó‡ªà‡∫≤‡∫ô‡ªÅ‡∫ô‡ªà‡ªÉ‡∫à‡∫ö‡ªç‡∫ß‡ªà‡∫≤‡∫ï‡ªâ‡∫≠‡∫á‡∫Å‡∫≤‡∫ô‡∫•‡∫ª‡∫ö‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫ô‡∫µ‡ªâ?</p> <button onclick="confirmDelete()"
                style="background:#d9534f;color:white;">‡∫•‡∫ª‡∫ö</button> <button onclick="cancelDelete()">‡∫ç‡∫ª‡∫Å‡ªÄ‡∫•‡∫µ‡∫Å</button>
        </div>
    </div>
    <div id="customAlertBox">
        <div id="customAlertContent">
            <p id="customAlertMessage">‡∫Å‡∫∞‡∫•‡∫∏‡∫ô‡∫≤‡∫Å‡∫≠‡∫Å‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡ªÉ‡∫´‡ªâ‡∫Ñ‡∫ª‡∫ö‡∫ñ‡ªâ‡∫ß‡∫ô</p>
            <button onclick="closeCustomAlert()">OK</button>
        </div>
    </div>
    <div id="appNotification" class="notification daily-reminder"></div>

    <div class="share-container">
        <h4>‡ªÅ‡∫ö‡ªà‡∫á‡∫õ‡∫±‡∫ô‡ªú‡ªâ‡∫≤‡ªÄ‡∫ß‡∫±‡∫ö‡∫ô‡∫µ‡ªâ (Share)</h4>
        <ul class="share-list">
            <li>
                <a href="#" class="share-btn btn-facebook" onclick="sharePage('facebook'); return false;"><i
                        class="fa fa-facebook"></i> Facebook</a>
            </li>
            <li>
                <a href="#" class="share-btn btn-twitter" onclick="sharePage('twitter'); return false;"><i
                        class="fa fa-twitter"></i> Twitter</a>
            </li>
            <li>
                <a href="#" class="share-btn btn-line" onclick="sharePage('line'); return false;"><i
                        class="fa fa-commenting-o"></i> Line</a>
            </li>
            <li>
                <a href="#" class="share-btn btn-whatsapp" onclick="sharePage('whatsapp'); return false;"><i
                        class="fa fa-whatsapp"></i> WhatsApp</a>
            </li>
            <li>
                <a href="#" class="share-btn btn-linkedin" onclick="sharePage('linkedin'); return false;"><i
                        class="fa fa-linkedin"></i> LinkedIn</a>
            </li>
        </ul>
        <p style="font-size: 12px; color: #888; margin-top: 10px;">
            *‡∫Å‡∫ª‡∫î‡ªÅ‡∫ö‡ªà‡∫á‡∫õ‡∫±‡∫ô‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡ªÅ‡∫ô‡∫∞‡∫ô‡∫≥‡∫•‡∫∞‡∫ö‡∫ª‡∫ö‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç‡∫ô‡∫µ‡ªâ‡ªÉ‡∫´‡ªâ‡ªù‡∫π‡ªà‡∫Ç‡∫≠‡∫á‡∫ó‡ªà‡∫≤‡∫ô</p>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        // ‡πÉ‡∏ä‡πâ Global variable 'firebase' ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£ import
        const firebaseConfig = {
            apiKey: "AIzaSyC8b0h8yyTo5th6UMrI4_dKUB1ZnvCwZBw",
            authDomain: "fuji-mobile-shop.firebaseapp.com",
            databaseURL: "https://fuji-mobile-shop-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "fuji-mobile-shop",
            storageBucket: "fuji-mobile-shop.appspot.com",
            messagingSenderId: "753053073037",
            appId: "1:753053073037:web:7c9cb46e055b91a4cf2cc4"
        };

        // ‡πÉ‡∏ä‡πâ firebase.initializeApp() ‡πÅ‡∏•‡∏∞ firebase.database()
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const monthSelect = document.getElementById("monthSelect");
        const currentYear = new Date().getFullYear();
        let EDIT_Y = "",
            EDIT_M = "",
            EDIT_KEY = "";
        let DELETE_Y = "",
            DELETE_M = "",
            DELETE_KEY = "";

        // --- üî• NEW: Text-to-Speech Function ---
        function speakText(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'th-TH';
                utterance.rate = 1.0;
                window.speechSynthesis.speak(utterance);
            } else {
                console.log("Speech Synthesis ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ");
            }
        }

        // Custom Alert Functions
        function showCustomAlert(message) {
            document.getElementById("customAlertMessage").textContent = message;
            document.getElementById("customAlertBox").style.display = "flex";
            // üî• MODIFIED: ‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á Alert ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
            speakText("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
        }

        window.closeCustomAlert = function () {
            document.getElementById("customAlertBox").style.display = "none";
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á Notification (‡∏à‡∏≥‡∏•‡∏≠‡∏á)
        function showNotification(message, type) {
            const notifBox = document.getElementById("appNotification");
            notifBox.textContent = message;
            notifBox.className = `notification ${type}`;
            notifBox.style.display = "block";
            notifBox.style.opacity = 1;

            setTimeout(() => {
                notifBox.style.opacity = 0;
                setTimeout(() => notifBox.style.display = "none", 500);
            }, 5000);
        }

        // Morning Reminder
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById("dateInput").value = new Date().toISOString().split('T')[0];
            const reminderMsg = "üîî ‡∫ß‡∫±‡∫ô‡∫ô‡∫µ‡ªâ‡∫¢‡ªà‡∫≤‡∫•‡∫∑‡∫°‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫õ‡∫∞‡∫à‡∫≥‡∫ß‡∫±‡∫ô‡∫î‡ªâ‡∫ß‡∫ç‡∫ô‡∫∞";
            showNotification(reminderMsg, "daily-reminder");

            // üî• MODIFIED: ‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
            speakText("‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
        });

        async function loadAvailableMonths() {
            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().once() ‡πÅ‡∏ó‡∏ô ref(db, ...)/get()
            const yearRef = db.ref(`expenses/${currentYear}`);
            const snapshot = await yearRef.once('value');

            monthSelect.innerHTML = "";
            if (!snapshot.exists()) {
                monthSelect.innerHTML = `<option value="">-- ‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô --</option>`;
                return;
            }
            snapshot.forEach(child => {
                const mm = child.key;
                const opt = document.createElement("option");
                opt.value = mm;
                opt.textContent = `‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô ${mm} / ${currentYear}`;
                monthSelect.appendChild(opt);
            });
            loadMonth();
        }

        window.saveExpense = async function () {
            const date = dateInput.value;
            const item = itemInput.value;
            const price = Number(priceInput.value);

            if (!date || !item || !price) {
                showCustomAlert("‡∫Å‡∫∞‚Äã‡∫•‡∫∏‚Äã‡∫ô‡∫≤‚Äã‡∫Å‡∫≠‡∫Å‚Äã‡∫Ç‡ªç‡ªâ‚Äã‡∫°‡∫π‡∫ô‚Äã‡ªÉ‡∫´‡ªâ‚Äã‡∫Ñ‡∫ª‡∫ö");
                return;
            }
            const y = date.split("-")[0];
            const m = date.split("-")[1];

            // 1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().push().set() ‡πÅ‡∏ó‡∏ô push(ref(db, ...))/set()
            const monthRef = db.ref(`expenses/${y}/${m}`);
            await monthRef.push().set({
                date,
                item,
                price
            });

            // 2. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ monthRef.once() ‡πÅ‡∏ó‡∏ô get(todayRef)
            const snapshot = await monthRef.once('value');
            let todayTotal = 0;
            const todayStr = dateInput.value;

            if (snapshot.exists()) {
                snapshot.forEach(child => {
                    const data = child.val();
                    if (data.date === todayStr) {
                        todayTotal += Number(data.price);
                    }
                });
            }

            // 3. Post-Save Total Notification
            const totalTextFormatted = todayTotal.toLocaleString("lo-LA");

            const speechMessage = `‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß. ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${totalTextFormatted} ‡∏Å‡∏µ‡∏ö`;

            const notificationMsg = `‚úî ‡∫ó‡ªà‡∫≤‡∫ô‡ªÑ‡∫î‡ªâ‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫™‡∫≥‡ªÄ‡∫•‡∫±‡∫î‡ªÅ‡∫•‡ªâ‡∫ß\n‡∫ß‡∫±‡∫ô‡∫ô‡∫µ‡ªâ‡∫ó‡ªà‡∫≤‡∫ô‡ªÉ‡∫ä‡ªâ‡∫à‡ªà‡∫≤‡∫ç‡ªÑ‡∫õ‡∫ó‡∫±‡∫á‡ªù‡∫ª‡∫î ${totalTextFormatted} ‡∫Å‡∫µ‡∫ö`;
            showNotification(notificationMsg, "save-complete");

            speakText(speechMessage);

            // 4. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
            loadAvailableMonths();
            loadMonth();

            // 5. ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            itemInput.value = "";
            priceInput.value = "";
        };

        window.loadMonth = function () {
            const m = monthSelect.value;
            const y = currentYear;
            const tableBody = document.getElementById("expenseTable");
            tableBody.innerHTML = "";
            if (!m) return;

            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().on('value', ...) ‡πÅ‡∏ó‡∏ô onValue(...)
            const monthRef = db.ref(`expenses/${y}/${m}`);
            monthRef.on('value', (snapshot) => {
                tableBody.innerHTML = "";
                let index = 1;
                let total = 0;
                let todayTotal = 0;
                const todayStr = document.getElementById("dateInput").value;

                snapshot.forEach(child => {
                    const key = child.key;
                    const data = child.val();
                    total += Number(data.price);
                    if (data.date === todayStr) {
                        todayTotal += Number(data.price);
                    }

                    // ‡πÉ‡∏ä‡πâ toLocaleString("lo-LA") ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≤‡∏ß
                    tableBody.innerHTML += `<tr> <td>${index++}</td> <td>${data.date}</td> <td>${data.item}</td> <td>${Number(data.price).toLocaleString("lo-LA")}</td> <td><button onclick="openEdit('${y}','${m}','${key}','${data.date}','${data.item}','${data.price}')">‚úè</button></td> <td><button onclick="askDelete('${y}','${m}','${key}')">üóë</button></td> </tr>`;
                });

                todayTotalText.textContent = "‡∫•‡∫ß‡∫°‡∫ß‡∫±‡∫ô‡∫ô‡∫µ‡ªâ: " + todayTotal.toLocaleString("lo-LA") + " ‡∫Å‡∫µ‡∫ö";
                totalText.textContent = "‡∫•‡∫ß‡∫°‡∫ó‡∫±‡∫á‡ªù‡∫ª‡∫î: " + total.toLocaleString("lo-LA") + " ‡∫Å‡∫µ‡∫ö";
            });
        };

        /** üî• ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Popup ‡∏•‡∏ö */
        window.askDelete = function (y, m, key) {
            DELETE_Y = y;
            DELETE_M = m;
            DELETE_KEY = key;
            document.getElementById("deleteConfirmBox").style.display = "flex";
            const thaiConfirmation = "‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏´‡∏° ‡∏ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏î‡∏•‡∏ö ‡∏ñ‡πâ‡∏≤‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å";
            speakText(thaiConfirmation);
        };

        /** üî• ‡∏Å‡∏î‡∏•‡∏ö‡∏à‡∏£‡∏¥‡∏á */
        window.confirmDelete = function () {
            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().child().remove() ‡πÅ‡∏ó‡∏ô remove(ref(db, ...))
            db.ref(`expenses/${DELETE_Y}/${DELETE_M}/${DELETE_KEY}`).remove().then(() => {
                document.getElementById("deleteConfirmBox").style.display = "none";
                loadMonth();
                speakText("‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß");
            });
        };

        /** ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å */
        window.cancelDelete = function () {
            document.getElementById("deleteConfirmBox").style.display = "none";
        };

        window.openEdit = function (y, m, key, date, item, price) {
            EDIT_Y = y;
            EDIT_M = m;
            EDIT_KEY = key;
            editDate.value = date;
            editItem.value = item;
            editPrice.value = price;
            document.getElementById("editBox").style.display = "flex";
        };

        window.closeEdit = function () {
            document.getElementById("editBox").style.display = "none";
        };

        window.saveEdit = function () {
            const newDate = editDate.value;
            const newItem = editItem.value;
            const newPrice = Number(editPrice.value);

            if (!newDate || !newItem || !newPrice) {
                showCustomAlert("‡∫Å‡∫∞‚Äã‡∫•‡∫∏‚Äã‡∫ô‡∫≤‚Äã‡∫Å‡∫≠‡∫Å‚Äã‡∫Ç‡ªç‡ªâ‚Äã‡∫°‡∫π‡∫ô‚Äã‡ªÉ‡∫´‡ªâ‚Äã‡∫Ñ‡∫ª‡∫ö");
                return;
            }
            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().child().update() ‡πÅ‡∏ó‡∏ô update(ref(db, ...))
            db.ref(`expenses/${EDIT_Y}/${EDIT_M}/${EDIT_KEY}`).update({
                date: newDate,
                item: newItem,
                price: newPrice
            }).then(() => {
                speakText("‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß");
                closeEdit();
                loadMonth();
            });
        };

        window.exportExcel = async function () {
            const m = monthSelect.value;
            const y = currentYear;
            if (!m) {
                speakText("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô");
                return;
            }

            // üî• MODIFIED: ‡πÉ‡∏ä‡πâ db.ref().once() ‡πÅ‡∏ó‡∏ô get(monthRef)
            const monthRef = db.ref(`expenses/${y}/${m}`);
            const snapshot = await monthRef.once('value');

            if (!snapshot.exists()) {
                speakText("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ");
                return;
            }
            let data = [
                ["‡∫ß‡∫±‡∫ô‡∫ó‡∫µ", "‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô", "‡∫•‡∫≤‡∫Ñ‡∫≤"]
            ];
            snapshot.forEach(child => {
                const d = child.val();
                data.push([d.date, d.item, d.price]);
            });
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Expenses");
            const filename = `expenses_${y}_${m}.xlsx`;
            XLSX.writeFile(wb, filename);

            speakText("Export Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß");
        };


        // ********** üî• NEW: Share Function **********
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á Social Media
        function sharePage(platform) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent("üí∞ ‡∫•‡∫∞‡∫ö‡∫ª‡∫ö‡∫ö‡∫±‡∫ô‡∫ó‡∫∂‡∫Å‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç‡∫õ‡∫∞‡∫à‡∫≥‡∫ß‡∫±‡∫ô (Expense Tracker)");
            const text = encodeURIComponent("‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏ô‡∏µ‡πâ‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞!");

            let shareUrl = '';

            switch (platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
                    break;
                case 'line':
                    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Line ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏ä‡πâ line://msg/text/
                    shareUrl = `https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`;
                    break;
                case 'whatsapp':
                    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö WhatsApp ‡πÉ‡∏ä‡πâ wapp.me ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö web browser, whatsapp://send ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mobile
                    shareUrl = `https://wa.me/?text=${text}%20${url}`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}&summary=${text}`;
                    break;
                default:
                    return;
            }

            // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå
            window.open(shareUrl, 'shareWindow', 'width=600,height=450,scrollbars=yes,resizable=yes');
        }
        // ‡∏ú‡∏π‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö Global scope
        window.sharePage = sharePage;
        // ************************************************************


        loadAvailableMonths();
    </script>
</body>

</html>
